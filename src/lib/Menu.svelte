<script lang="ts">
    import { createEventDispatcher } from 'svelte';
    import { Looks } from './Looks';

    const dispatch = createEventDispatcher<{ toggle: null, pause: null, download: null }>();

    export let li: number;
    export let supersample: number;

    export let started: boolean;
    export let playing: boolean;

</script>

<div class="menu">
    <button class="play-pause" on:click={() => dispatch( 'toggle' )}>
        {#if playing}
            <svg viewBox="0 -960 960 960"><path d="M559.5-252v-456h138v456h-138Zm-296 0v-456h139v456h-139Z"/></svg>
        {:else}
            <svg viewBox="0 -960 960 960"><path d="M372-295v-372l292 186-292 186Z"/></svg>
        {/if}
    </button>

    <select class="look" bind:value={li} disabled={playing}>
        {#each Looks as l, i}
            <option value={i}>{l.name}</option>
        {/each}
    </select>

    <select class="res" bind:value={supersample} disabled={playing}>
        <option value={.25}>x.25</option>
        <option value={.5}>x.5</option>
        <option value={1}>x1</option>
        <option value={2}>x2</option>
        <option value={4}>x4</option>
    </select>

    <button class="download" disabled={!started || playing} on:click={() => dispatch( 'download' )}>
        <svg viewBox="0 0 20 16" style="transform: scale(.4)">
            <path d="M0 0 L20 0 L10 12 Z" />
            <rect x=0 y=14 width=100% height=4 />
        </svg>
    </button>
</div>



<style>
    .menu {
        flex: 0 0 auto;

        display: flex;
        flex-flow: row nowrap;
        align-items: stretch;
        gap: 8px;

        --a: max( 48px, 5vmin );
    }

    button,
    select {
        flex: 1 1 auto;

        appearance: none;
        min-width: 0;
        max-width: 60%;
        height: calc( var(--a) * 1.5 );

        color: var(--fg);
        accent-color: var(--fg);
        border-radius: 8px;

        margin: 0;
        padding: 0;

        background: rgba(0,0,0,0.04);

        border: 0;
        font-size: var(--a);
        line-height: 1.5;
        text-align: center;
        font-family: inherit;
        overflow: hidden;
    }

    button:not( :disabled ):hover,
    button:not( :disabled ):focus-visible,
    select:not( :disabled ):hover,
    select:not( :disabled ):focus-visible {
        outline: none;
        cursor: pointer;
        z-index: 1;

        box-shadow: inset 0 0 0 4px var(--fg);
    }
    select:focus {
        background: var(--bg);
    }
    button:disabled,
    select:disabled {
        opacity: 0.25;
    }

    button {
        display: flex;
        flex-flow: row nowrap;
        justify-content: center;
        align-items: center;
    }
    svg {
        height: 1em;
        width: 1em;
        fill: currentColor;
    }


    @media (max-width: 600px) {
        button, select {
            height: calc( var(--a) * 1 );
            line-height: 1.2;
            font-size: 40px;
        }

        .play-pause {
            flex: 0 0 20%;
        }
        .look {
            flex: 1 1 auto;
            font-size: 22px;
        }
        .res {
            flex: 0 0 15%;
            font-size: 22px;
        }
        .download {
            flex: 0 0 20%;
        }
    }


</style>
